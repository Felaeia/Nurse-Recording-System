USE [NurseRecordingSystem]
GO

/****** Object:  StoredProcedure [dbo].[usp_CreateUserForm]    Script Date: 11/3/2025 5:59:03 PM ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO


CREATE PROCEDURE [dbo].[usp_CreateUserForm]
	@IssueType NVARCHAR(MAX),
	@IssueDescryption NVARCHAR(MAX),
	@Status NVARCHAR(10), 
	@UserId INT,
	@PatientName NVARCHAR(MAX),
	@CreatorName NVARCHAR(50), 
	@UpdaterName NVARCHAR(50), 
	@IsActive BIT
AS
BEGIN
	SET NOCOUNT ON;

	DECLARE @CurrentTime DATETIME2(7) = SYSUTCDATETIME();

	INSERT INTO [PatientForms]
		(
            issueType, 
            issueDescryption, 
            status, 
            userId, 
            patientName, 
            createdOn, 
            updatedOn, 
            createdBy, 
            updatedBy,  
            isActive
        )
    VALUES 
		(
            @IssueType, 
            @IssueDescryption, 
            @Status, 
            @UserId, 
            @PatientName, 
            @CurrentTime, -- Creation Time Stamp
            @CurrentTime, -- Initial Update Time Stamp
            @CreatorName,
            @UpdaterName,
            @IsActive
        );

    -- This is the new line you need to add.
    -- It selects the 'formId' that was just created.
    SELECT SCOPE_IDENTITY() AS NewFormId;
END
GO


